# =============================================================================
# TractStack Server Configuration
# =============================================================================
# These are defaults optimized for minimum hardware specs (1GB RAM, 1 CPU).
# For production with more resources, increase these values accordingly.

# Server
PORT=8080

# Cache Limits (Memory Management)
MAX_TENANTS=5                    # Number of tenants to cache simultaneously
MAX_MEMORY_MB=768               # Cache memory limit (~75% of 1GB RAM)
MAX_SESSIONS_PER_TENANT=5000    # Sessions per tenant (affects memory usage)

# Database Pool Configuration (Connection Management) 
DB_MAX_OPEN_CONNS=10            # Max concurrent DB connections (CPU limited)
DB_MAX_IDLE_CONNS=3             # Idle connections kept in pool
DB_CONN_MAX_LIFETIME_MINUTES=30 # Force connection recreation (prevents stale)
DB_CONN_MAX_IDLE_MINUTES=3      # Max idle time before closing

# SSE (Server-Sent Events) Configuration
MAX_SESSIONS_PER_CLIENT=10000   # Global SSE connection limit
MAX_SESSION_CONNECTIONS=3       # SSE connections per browser session
SSE_CONNECTION_TIMEOUT_MINUTES=30        # SSE connection max duration
SSE_HEARTBEAT_INTERVAL_SECONDS=30        # Heartbeat frequency
SSE_INACTIVITY_TIMEOUT_MINUTES=5         # Disconnect after inactivity

# Cache TTL Configuration (Performance Tuning)
CONTENT_CACHE_TTL_HOURS=24      # How long to cache content
USER_STATE_TTL_HOURS=2          # How long to cache user state
HTML_CHUNK_TTL_HOURS=1          # How long to cache HTML fragments
ANALYTICS_BIN_TTL_DAYS=28       # How long to keep analytics data
CURRENT_HOUR_TTL_MINUTES=15     # Current analytics refresh rate
LEAD_METRICS_TTL_MINUTES=5      # Lead metrics refresh rate

# Cleanup Intervals (Background Maintenance)
CACHE_CLEANUP_INTERVAL_MINUTES=30       # Cache cleanup frequency
TENANT_TIMEOUT_HOURS=4                  # Evict inactive tenants after
SSE_CLEANUP_INTERVAL_MINUTES=5          # SSE connection cleanup frequency
DB_POOL_CLEANUP_INTERVAL_MINUTES=5      # DB pool cleanup frequency
